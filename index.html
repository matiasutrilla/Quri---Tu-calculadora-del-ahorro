<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Quri — tu calculadora de ahorro</title>

  <!-- Fuentes -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">

  <!-- Estilos -->
  <style>
    :root{
      --ink:#dfe7ff;
      --muted:#94a3b8;
      --bg:#0f172a;
      --card:#111827;
      --gold:#facc15;
      --gold-700:#b68d00;
      --accent:#22c55e;
      --accent-900:#14532d;
      --danger:#f97316;
      --stroke:rgba(255,255,255,.08);
      --shadow:0 8px 24px rgba(0,0,0,.35);
      --radius:16px;
    }
    *{box-sizing:border-box}
    html,body{margin:0;background:var(--bg);color:var(--ink);font-family:Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;}
    img{max-width:100%;display:block}

    header{
      display:flex;align-items:center;gap:12px;
      padding:18px 20px 8px 20px;margin:0 auto;max-width:1200px;
    }
    header .brand{display:flex;align-items:center;gap:10px}
    header .brand img{height:20px;opacity:.95}
    header h1{font-size:18px;margin:0;font-weight:800;letter-spacing:.2px}
    header .tag{font-size:12px;color:var(--muted);margin-top:2px}

    .goldbar{height:4px;background:linear-gradient(90deg,var(--gold),#ffe27a 60%,var(--gold));box-shadow:0 1px 0 #000 inset}

    .wrap{max-width:1200px;margin:24px auto;padding:0 20px}
    .grid{display:grid;grid-template-columns:1fr 1fr;gap:22px;}
    @media (max-width: 980px){ .grid{grid-template-columns:1fr;} }

    .card{
      background:linear-gradient(180deg,#0f172a 0%, #0b1222 100%);
      border:1px solid var(--stroke);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
    }
    .card .hd{padding:18px 18px 10px 18px;font-weight:800;letter-spacing:.2px;font-size:18px;}
    .card .bd{padding:16px 18px 18px 18px}

    .form-grid{display:grid;grid-template-columns:1fr 1fr;gap:14px;}
    .field{display:flex;flex-direction:column;gap:6px}
    .label{color:var(--muted);font-size:13px}
    input, select{
      width:100%;padding:12px 14px;border-radius:12px;
      background:#0a1326;border:1px solid var(--stroke);color:var(--ink);
      outline:none;transition:.2s border;
    }
    input::placeholder{color:#6b7280}
    input:focus, select:focus{border-color:#355cff}

    .prod{display:flex;align-items:center;gap:14px;padding:12px;border-radius:14px;border:1px solid var(--stroke);cursor:pointer;transition:.2s border, .2s background;position:relative}
    .prod:hover{border-color:#2b3758;background:#0d162b}
    .prod.sel{border-color:var(--gold);box-shadow:0 0 0 3px rgba(250,204,21,.15) inset}
    .prod img{width:52px;height:52px;object-fit:contain;border-radius:10px;background:#0b1428;border:1px solid var(--stroke)}
    .prod .meta{display:flex;flex-direction:column}
    .prod .title{font-weight:700}
    .prod .sub{font-size:12px;color:var(--muted)}

    .ribbon{
      position:absolute;right:-8px;top:-8px;transform:rotate(35deg);
      background:linear-gradient(90deg,#ffe27a,var(--gold));
      color:#000;font-weight:800;font-size:12px;padding:6px 22px;border-radius:10px;box-shadow:var(--shadow);border:1px solid rgba(0,0,0,.25)
    }

    .result .tile{background:linear-gradient(180deg,#0e162b,#0b1324);border:1px solid var(--stroke);border-radius:14px;padding:16px;margin-top:12px;}
    .kpi{font-size:42px;font-weight:800;letter-spacing:.3px}
    .kpi small{font-size:12px;color:var(--muted);display:block;margin-top:6px}
    .row-2{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    @media (max-width: 980px){ .row-2{grid-template-columns:1fr} }

    .progressbar{height:10px;border-radius:999px;background:#0a1326;border:1px solid var(--stroke);overflow:hidden}
    .progressbar > span{display:block;height:100%;background:linear-gradient(90deg,#34d399,#22c55e);width:0%}

    .loyalty{border:2px dashed rgba(250,204,21,.35);background:rgba(250,204,21,.06);}
    .loyalty h4{margin:0 0 4px 0;font-size:15px}
    .loyalty p{margin:4px 0 0 0;color:var(--muted);font-size:14px}

    .cta{background:linear-gradient(180deg,#0c1f13,#0a1a10);border:1px solid #16351f;border-radius:14px;padding:16px;margin-top:12px}
    .cta .mail{background:#041c0f;border:1px solid #134e35;border-radius:10px;padding:10px 12px;color:#b9ffd6;font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace}
    .cta .btn{margin-top:10px;background:var(--accent);border:none;color:#052e16;font-weight:800;padding:12px 14px;border-radius:10px;cursor:pointer}
    .cta small{display:block;margin-top:6px;color:#a7f3d0}

    .actions{display:flex;gap:12px;margin-top:12px}
    .btn{padding:12px 16px;border-radius:12px;border:1px solid var(--stroke);background:#0b1428;color:var(--ink);cursor:pointer;font-weight:800;}
    .btn.primary{background:linear-gradient(180deg,#ef4444,#dc2626);border:1px solid #7f1d1d}
    .btn:hover{filter:brightness(1.06)}

    .logo{height:22px;opacity:.95}
  </style>

  <!-- html2canvas + jsPDF -->
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
</head>
<body>

  <header>
    <div class="brand">
      <img class="logo" src="assets/alicorp_logo.png" alt="Alicorp" />
      <div>
        <h1>Quri — tu calculadora de ahorro</h1>
        <div class="tag">Buscando el dorado perfecto que rinde más</div>
      </div>
    </div>
  </header>
  <div class="goldbar"></div>

  <div class="wrap">
    <div class="grid">
      <!-- Izquierda -->
      <section class="card">
        <div class="hd">Tu consumo de aceite hoy</div>
        <div class="bd">
          <div class="form-grid">
            <div class="field">
              <label class="label">Precio por balde (S/) — aceite actual</label>
              <input id="precioActual" type="number" min="0" step="0.01" placeholder="Ej. 124">
            </div>
            <div class="field">
              <label class="label">Litros por balde actual (L)</label>
              <input id="litrosActual" type="number" min="1" step="1" value="18">
            </div>
            <div class="field">
              <label class="label">Baldes por semana</label>
              <input id="baldesSemana" type="number" min="0" step="1" placeholder="Ej. 3">
            </div>
            <div class="field">
              <label class="label">Número de locales</label>
              <input id="locales" type="number" min="1" step="1" placeholder="Ej. 1">
            </div>
          </div>

          <div style="height:14px"></div>
          <div class="hd" style="padding:0 0 8px 0;font-size:16px;color:#e5e7eb;font-weight:800">Elige tu aceite especializado</div>

          <div id="cards">
            <div class="prod" data-id="crisol" data-precio="160" data-litros="20" data-plus="0.50" tabindex="0" role="button" aria-label="Crisol Fritura Intensa">
              <img src="assets/crisol.png" alt="Crisol Fritura Intensa">
              <div class="meta">
                <div class="title">Crisol Fritura Intensa</div>
                <div class="sub">S/ 160 · 20 L · Excelencia en frituras</div>
              </div>
              <span class="ribbon">+50% rendimiento</span>
            </div>

            <div class="prod" data-id="tondero" data-precio="130" data-litros="20" data-plus="0.30" tabindex="0" role="button" aria-label="Tondero Premium Fritura Intensa">
              <img src="assets/tondero.png" alt="Tondero Premium Fritura Intensa">
              <div class="meta">
                <div class="title">Tondero Premium Fritura Intensa</div>
                <div class="sub">S/ 130 · 20 L · Rendimiento confiable</div>
              </div>
              <span class="ribbon">+30% rendimiento</span>
            </div>

            <div class="prod" data-id="friol" data-precio="135" data-litros="18" data-plus="0" tabindex="0" role="button" aria-label="Friol Ultra (no especializado)">
              <img src="assets/friol.png" alt="Friol Ultra">
              <div class="meta">
                <div class="title">Friol Ultra <span style="color:#a1a1aa">(no especializado)</span></div>
                <div class="sub">S/ 135 · 18 L</div>
              </div>
            </div>
          </div>

          <div style="height:12px"></div>
          <div class="form-grid">
            <div class="field">
              <label class="label">Precio por balde — seleccionado (S/)</label>
              <input id="precioSel" type="number" min="0" step="0.01" placeholder="—" disabled>
            </div>
            <div class="field">
              <label class="label">Litros por balde — seleccionado (L)</label>
              <input id="litrosSel" type="number" min="1" step="1" placeholder="—" disabled>
            </div>
          </div>

          <div style="height:12px"></div>
          <div class="field" style="max-width:260px">
            <label class="label">Periodo de análisis</label>
            <select id="periodo">
              <option value="mes" selected>Por mes</option>
              <option value="semana">Por semana</option>
            </select>
          </div>

          <div class="actions">
            <button id="btnPdf" class="btn primary">Guardar resultados (PDF)</button>
            <button id="btnClear" class="btn">Limpiar datos</button>
          </div>
        </div>
      </section>

      <!-- Derecha -->
      <section class="card result" id="panelResultados">
        <div class="hd">Resultado de tu transformación</div>
        <div class="bd">

          <div id="lealtad" class="tile loyalty" style="display:none">
            <h4>🟡 Crisol — Plan de Lealtad</h4>
            <p>Acumulas <b id="pts">0</b> puntos (1 punto por cada S/10 gastados en Crisol Fritura Intensa).</p>
          </div>

          <div class="tile">
            <div style="font-weight:800;margin-bottom:6px">🔥 Ahorro estimado</div>
            <div class="kpi">S/ <span id="ahorro">0.00</span> <small id="notaAhorro">—</small></div>
          </div>

          <div class="row-2">
            <div class="tile">
              <div style="display:flex;align-items:center;gap:8px"><span style="width:10px;height:10px;background:#334155;border-radius:3px;border:1px solid var(--stroke)"></span><b>Gasto actual (mes)</b></div>
              <div class="kpi" style="font-size:28px;margin-top:6px">S/ <span id="gActual">0.00</span></div>
            </div>
            <div class="tile">
              <div style="display:flex;align-items:center;gap:8px"><span style="width:10px;height:10px;background:#334155;border-radius:3px;border:1px solid var(--stroke)"></span><b>Gasto con seleccionado (mes)</b></div>
              <div class="kpi" style="font-size:28px;margin-top:6px">S/ <span id="gSel">0.00</span></div>
            </div>
          </div>

          <div class="tile">
            <div style="display:flex;align-items:center;gap:8px"><span style="width:10px;height:10px;background:var(--danger);border-radius:3px;border:1px solid #7c2d12"></span><b>Progreso de ahorro</b></div>
            <div class="progressbar" style="margin-top:10px"><span id="bar" style="width:0%"></span></div>
            <div style="margin-top:6px;color:var(--muted);font-size:13px">Ahorro del <b id="pct">0%</b> vs. situación actual.</div>
          </div>

          <div class="tile">
            <div style="display:flex;align-items:center;gap:8px"><span style="width:10px;height:10px;background:#334155;border-radius:3px;border:1px solid var(--stroke)"></span><b>¿Hasta cuánto podrías pagar por balde sin gastar más?</b></div>
            <div class="kpi" style="font-size:28px;margin-top:6px">S/ <span id="breakEven">—</span></div>
            <div style="color:var(--muted);font-size:12px" id="breakNote"></div>
          </div>

          <div class="cta">
            <div style="font-weight:800;margin-bottom:6px">¿Quieres comprobar este rendimiento en tu cocina? 🚀</div>
            <div class="mail">asesoriatecnica@alicorp.com.pe</div>
            <button class="btn" style="background:var(--accent);color:#052e16;font-weight:800;margin-top:10px">Quiero recibir asesoría técnica</button>
            <small>Se enviará un correo con el resumen de tu análisis.</small>
          </div>
        </div>
      </section>
    </div>
  </div>

<script>
(() => {
  const $ = s => document.querySelector(s);
  const $$ = s => [...document.querySelectorAll(s)];

  const inputs = {
    precioActual: $('#precioActual'),
    litrosActual: $('#litrosActual'),
    baldesSemana: $('#baldesSemana'),
    locales: $('#locales'),
    precioSel: $('#precioSel'),
    litrosSel: $('#litrosSel'),
    periodo: $('#periodo')
  };

  const out = {
    ahorro: $('#ahorro'),
    notaAhorro: $('#notaAhorro'),
    gActual: $('#gActual'),
    gSel: $('#gSel'),
    bar: $('#bar'),
    pct: $('#pct'),
    breakEven: $('#breakEven'),
    breakNote: $('#breakNote'),
    lealtad: $('#lealtad'),
    pts: $('#pts')
  };

  const productos = $$('#cards .prod');
  let sel = null;

  productos.forEach(card => {
    card.addEventListener('click', () => selectCard(card));
    card.addEventListener('keypress', (e)=>{ if(e.key==='Enter' || e.key===' ') selectCard(card); });
  });

  function selectCard(card){
    productos.forEach(c=>c.classList.remove('sel'));
    card.classList.add('sel');

    sel = {
      id: card.dataset.id,
      precio: Number(card.dataset.precio),
      litros: Number(card.dataset.litros),
      plus: Number(card.dataset.plus)
    };

    inputs.precioSel.value = sel.precio.toFixed(2);
    inputs.litrosSel.value = sel.litros;

    out.lealtad.style.display = sel.id === 'crisol' ? '' : 'none';
    recalc();
  }

  $$('#periodo, input').forEach(el => el.addEventListener('input', recalc));

  function v(n){ const x = Number(n); return isFinite(x) ? x : 0; }
  const fmt = n => n.toLocaleString('es-PE', {minimumFractionDigits:2, maximumFractionDigits:2});

  function recalc(){
    const pa = v(inputs.precioActual.value);
    const la = Math.max(1, v(inputs.litrosActual.value) || 18);
    const bs = v(inputs.baldesSemana.value);
    const loc = Math.max(1, v(inputs.locales.value) || 1);
    const per = inputs.periodo.value;

    const baldesPeriodo = per === 'mes' ? bs * 4 * loc : bs * loc;
    const gastoActual = pa * baldesPeriodo;

    if(!sel){
      out.gActual.textContent = fmt(gastoActual);
      out.gSel.textContent = fmt(0);
      out.ahorro.textContent = fmt(0);
      out.notaAhorro.textContent = '—';
      out.pct.textContent = '0%';
      out.bar.style.width = '0%';
      out.breakEven.textContent = '—';
      out.breakNote.textContent = '';
      out.pts.textContent = '0';
      return;
    }

    const ls = sel.litros;
    const plus = 1 + sel.plus;

    const baldesSelNecesarios = (baldesPeriodo * la) / (ls * plus);
    const gastoSel = sel.precio * baldesSelNecesarios;

    const ahorro = Math.max(0, gastoActual - gastoSel);
    const pct = gastoActual > 0 ? (ahorro / gastoActual) * 100 : 0;

    out.gActual.textContent = fmt(gastoActual);
    out.gSel.textContent = fmt(gastoSel);
    out.ahorro.textContent = fmt(ahorro);
    out.notaAhorro.textContent = gastoActual>0 ? `≈ ${fmt((ahorro / pa) || 0)} baldes gratis/mes` : '—';
    out.pct.textContent = `${fmt(pct)}%`;
    out.bar.style.width = `${Math.min(100, Math.max(0, pct))}%`;

    const breakEven = baldesSelNecesarios > 0 ? (gastoActual / baldesSelNecesarios) : 0;
    out.breakEven.textContent = fmt(breakEven);
    out.breakNote.textContent = sel ? `Precio máximo por balde del aceite seleccionado.` : '';

    if(sel.id === 'crisol'){
      const puntos = Math.floor(gastoSel / 10);
      out.pts.textContent = puntos.toString();
    }
  }

  $('#btnPdf').addEventListener('click', async () => {
    const node = $('#panelResultados');
    const canvas = await html2canvas(node, {scale: 2, backgroundColor: null});
    const imgData = canvas.toDataURL('image/png');

    const { jsPDF } = window.jspdf;
    const pdf = new jsPDF({orientation:'portrait', unit:'pt', format:'a4'});

    const pageW = pdf.internal.pageSize.getWidth();
    const pageH = pdf.internal.pageSize.getHeight();
    const ratio = Math.min(pageW / canvas.width, pageH / canvas.height);
    const w = canvas.width * ratio, h = canvas.height * ratio;
    const x = (pageW - w)/2, y = 24;

    pdf.addImage(imgData, 'PNG', x, y, w, h);
    pdf.save('Quri_resultados.pdf');
  });

  $('#btnClear').addEventListener('click', () => {
    inputs.precioActual.value = '';
    inputs.litrosActual.value = 18;
    inputs.baldesSemana.value = '';
    inputs.locales.value = '';
    inputs.precioSel.value = '';
    inputs.litrosSel.value = '';
    sel = null;
    productos.forEach(c=>c.classList.remove('sel'));
    recalc();
    window.scrollTo({top:0,behavior:'smooth'});
  });

  recalc();
})();
</script>
</body>
</html>
